% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mppi_adv_methods.R
\name{mppi_sdppi_fit}
\alias{mppi_sdppi_fit}
\title{Trial-resolved state-dependent PPI analysis}
\usage{
mppi_sdppi_fit(
  fit,
  k,
  onsets_idx,
  runs,
  Wpre = 8L,
  Wpost = 12L,
  mode = c("neural", "innov"),
  TR = NULL,
  protect = "lowK",
  K_keep = 8L,
  f_cut = 0.03,
  ar_order = "auto",
  p = 4L,
  nuisance_ts = NULL
)
}
\arguments{
\item{fit}{multiPPI fit (neural or BOLD domain)}

\item{k}{condition index}

\item{onsets_idx}{integer TR indices for events}

\item{runs}{run label per TR}

\item{Wpre}{number of TRs in pre-event window}

\item{Wpost}{number of TRs in post-event window}

\item{mode}{"neural" or "innov"}

\item{TR}{repetition time (needed when innovations protect = "lowHz")}

\item{protect}{innovations strategy}

\item{K_keep}{DCT components when protect = "lowK"}

\item{f_cut}{Hz cutoff when protect = "lowHz"}

\item{ar_order}{innovations AR mode}

\item{p}{maximum AR order}

\item{nuisance_ts}{named list of nuisance timeseries (length T)}
}
\value{
list with trial data, models, and cross-validated correlation
}
\description{
Trial-resolved state-dependent PPI analysis
}
