% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mppi_adv_methods.R, R/mppi_lag.R
\name{mppi_lagged.mppi_fit}
\alias{mppi_lagged.mppi_fit}
\alias{mppi_lagged}
\alias{mppi_lagged.default}
\title{Short-lag task-gated coupling matrices}
\usage{
\method{mppi_lagged}{mppi_fit}(
  fit,
  k,
  lags = -2:2,
  mode = c("neural", "innov"),
  protect = "lowK",
  K_keep = 8L,
  f_cut = 0.03,
  TR = NULL,
  ar_order = "auto",
  p = 4L
)

mppi_lagged(x, ...)

\method{mppi_lagged}{default}(
  Y,
  X,
  psych_idx,
  lags = -2:2,
  blocklens = NULL,
  zero_diag = TRUE,
  scale = c("cov", "corr")
)
}
\arguments{
\item{fit}{multiPPI fit}

\item{k}{condition index}

\item{lags}{integer vector of lags (e.g., -2:2). Positive = delay p_k.}

\item{mode}{"neural" uses stored series; "innov" applies \code{mppi_innovations}}

\item{protect}{strategy for innovations}

\item{K_keep}{DCT components when protect = "lowK"}

\item{f_cut}{Hz cutoff when protect = "lowHz"}

\item{TR}{repetition time for protect = "lowHz"}

\item{ar_order}{AR order mode for innovations}

\item{p}{maximum AR order}

\item{Y}{T x V data}

\item{X}{T x q design}

\item{psych_idx}{indices of psychological main effects}

\item{blocklens}{integer vector of run lengths (TR units) to prevent cross-run spillover}
}
\value{
list with matrices per lag and routing index R
}
\description{
Short-lag task-gated coupling matrices

Lagged Matrix-PPI (directed)
}
