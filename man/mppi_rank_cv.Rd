% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mppi_rank_cv.R
\name{mppi_rank_cv}
\alias{mppi_rank_cv}
\title{Cross-validated rank selection for ΔΣ (component space recommended)}
\usage{
mppi_rank_cv(R, pk, Delta, holdout_frac = 0.2, R_reps = 3)
}
\arguments{
\item{R}{Residualized time series in the working space (T × V or T × r).}

\item{pk}{Residualized psychological regressor (length T).}

\item{Delta}{Optional observed slope matrix (V × V); retained for backward
compatibility but recomputed internally from \code{R}/\code{pk} in each split.}

\item{holdout_frac}{Fraction of time points for hold-out blocks.}

\item{R_reps}{Number of random splits.}
}
\value{
List with the selected rank \code{r}, per-rank losses, and the rank grid.
}
\description{
This helper recomputes task-modulated slopes on training/validation splits and
scores low-rank approximations via held-out Frobenius loss. It is agnostic to
whether you operate in voxel/ROI or basis space, but for high-dimensional
data you should supply the reduced residual matrix (e.g., \code{fit$Z}) together
with its corresponding slope matrix (\code{mppi_get_M(fit, k)}) so the SVD is
performed on an r × r matrix rather than a 50k × 50k object.
}
